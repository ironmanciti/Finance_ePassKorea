# ---
# jupyter:
#   jupytext:
#     formats: ipynb,py:percent
#     text_representation:
#       extension: .py
#       format_name: percent
#       format_version: '1.3'
#       jupytext_version: 1.17.3
#   kernelspec:
#     display_name: Python 3 (ipykernel)
#     language: python
#     name: python3
# ---

# %% [markdown]
# # 39차시: [프로젝트] 투자 분석 자동화 시스템 구축 - 기획
#
# ## 학습 목표
# - 모듈 1-4에서 학습한 내용을 종합
# - '나만의 투자 분석 자동화 시스템' 기획
# - 데이터 수집 → 분석 → 리포팅 파이프라인 설계
#
# ## 프로젝트 범위
# - 개인화된 투자 분석 자동화 시스템
# - 일일/주간 리포트 자동 생성
# - (선택) 대시보드 또는 이메일 발송

# %% [markdown]
# ---
# ## 1. 프로젝트 개요
#
# ### 1.1 시스템 목표
# 개인 투자자를 위한 자동화된 투자 분석 시스템을 구축합니다.
#
# ```
# ┌─────────────────────────────────────────────────────────────┐
# │                    투자 분석 자동화 시스템                     │
# ├─────────────────────────────────────────────────────────────┤
# │                                                             │
# │   [데이터 수집]  →  [분석/처리]  →  [시각화]  →  [리포트]    │
# │                                                             │
# │   - pykrx         - Pandas       - Matplotlib  - PDF       │
# │   - FRED API      - 통계 분석    - Plotly      - Excel     │
# │   - 크롤링        - AI 분석      - Streamlit   - 이메일    │
# │                                                             │
# └─────────────────────────────────────────────────────────────┘
# ```
#
# ### 1.2 핵심 기능
# 1. **데이터 자동 수집**: 주가, 경제지표, 뉴스
# 2. **분석 자동화**: 기술적 분석, AI 분석
# 3. **리포트 자동 생성**: PDF/Excel
# 4. **(선택) 대시보드**: Streamlit 웹 앱
# 5. **(선택) 알림 발송**: 이메일 자동 발송

# %% [markdown]
# ---
# ## 2. 시스템 아키텍처
#
# ### 2.1 전체 구조
#
# ```
# ┌──────────────────────────────────────────────────────────────────┐
# │                        데이터 소스                               │
# ├────────────────┬─────────────────┬──────────────────────────────┤
# │   pykrx        │   FRED API      │   웹 크롤링                   │
# │   (국내 주식)   │   (경제지표)     │   (뉴스, 시장지표)            │
# └────────────────┴─────────────────┴──────────────────────────────┘
#                              │
#                              ▼
# ┌──────────────────────────────────────────────────────────────────┐
# │                     데이터 저장 (SQLite)                         │
# └──────────────────────────────────────────────────────────────────┘
#                              │
#                              ▼
# ┌──────────────────────────────────────────────────────────────────┐
# │                        분석 엔진                                 │
# ├──────────────────┬────────────────┬─────────────────────────────┤
# │   기술적 분석     │   통계 분석     │   AI/LLM 분석               │
# │   - 이동평균      │   - 수익률      │   - 감성분석                │
# │   - RSI, MACD    │   - 변동성      │   - 요약/해석               │
# └──────────────────┴────────────────┴─────────────────────────────┘
#                              │
#                              ▼
# ┌──────────────────────────────────────────────────────────────────┐
# │                        출력 레이어                               │
# ├──────────────────┬────────────────┬─────────────────────────────┤
# │   대시보드        │   리포트        │   알림                       │
# │   (Streamlit)    │   (PDF/Excel)  │   (이메일)                   │
# └──────────────────┴────────────────┴─────────────────────────────┘
# ```
#
# ### 2.2 모듈별 매핑
#
# | 레이어 | 모듈 | 차시 |
# |--------|------|------|
# | 데이터 수집 | 모듈 1, 2 | 4, 8, 11-16 |
# | 데이터 저장 | 모듈 2 | 16 |
# | 분석 엔진 | 모듈 1, 3 | 9-10, 19-31 |
# | 대시보드 | 모듈 4 | 33-36 |
# | 리포트 | 모듈 4 | 37-38 |
# | 알림 | 모듈 2, 4 | 17-18, 38 |

# %% [markdown]
# ---
# ## 3. 프로젝트 설계 템플릿
#
# ### 3.1 프로젝트 정의서
#
# 아래 템플릿을 작성하여 프로젝트를 구체화하세요.

# %%
project_template = """
================================================================================
                        투자 분석 자동화 시스템 - 프로젝트 정의서
================================================================================

1. 프로젝트 이름: ________________________________

2. 목표
   - 주요 목표: ________________________________
   - 예상 사용자: ________________________________
   - 해결하려는 문제: ________________________________

3. 범위
   □ 데이터 수집
     - [ ] 국내 주식 (pykrx)
     - [ ] 미국 주식 (yfinance)
     - [ ] 경제 지표 (FRED API)
     - [ ] 뉴스 (웹 크롤링)
     - [ ] 공시 (DART API)
   
   □ 분석 기능
     - [ ] 기술적 분석 (이동평균, RSI, MACD)
     - [ ] 포트폴리오 분석 (수익률, 변동성, 샤프비율)
     - [ ] AI 분석 (감성분석, LLM 요약)
   
   □ 출력
     - [ ] Streamlit 대시보드
     - [ ] PDF 리포트
     - [ ] Excel 리포트
     - [ ] 이메일 발송
   
   □ 자동화
     - [ ] 스케줄링 (매일/매주)
     - [ ] 데이터베이스 저장

4. 기술 스택
   - 데이터 수집: ________________________________
   - 분석: ________________________________
   - 시각화: ________________________________
   - 리포트: ________________________________
   - 자동화: ________________________________

5. 일정 (40차시 발표 기준)
   - 데이터 수집 완료: ________________________________
   - 분석 로직 완료: ________________________________
   - 출력 레이어 완료: ________________________________
   - 통합 테스트: ________________________________

6. 예상 결과물
   - ________________________________
   - ________________________________
   - ________________________________

================================================================================
"""

print(project_template)

# %% [markdown]
# ### 3.2 체크리스트

# %%
checklist = """
================================================================================
                        프로젝트 체크리스트
================================================================================

[ ] 1. 프로젝트 정의서 작성 완료
[ ] 2. 환경 설정
    [ ] 필요한 라이브러리 설치
    [ ] API 키 설정 (.env)
    [ ] 폴더 구조 생성

[ ] 3. 데이터 수집 모듈
    [ ] 주가 데이터 수집 함수
    [ ] 경제 지표 수집 함수
    [ ] (선택) 뉴스/공시 수집 함수
    [ ] 테스트 완료

[ ] 4. 분석 모듈
    [ ] 기본 통계 분석
    [ ] 기술적 지표 계산
    [ ] (선택) AI/LLM 분석
    [ ] 테스트 완료

[ ] 5. 출력 모듈
    [ ] 차트 생성 함수
    [ ] PDF/Excel 리포트 생성
    [ ] (선택) Streamlit 대시보드
    [ ] 테스트 완료

[ ] 6. 통합
    [ ] 전체 파이프라인 연결
    [ ] 에러 처리
    [ ] 통합 테스트

[ ] 7. (선택) 자동화
    [ ] 스케줄링 설정
    [ ] 이메일 발송 설정

[ ] 8. 발표 준비
    [ ] 발표 자료 작성
    [ ] 데모 준비
    [ ] Q&A 대비

================================================================================
"""

print(checklist)

# %% [markdown]
# ---
# ## 4. 프로젝트 코드 템플릿
#
# ### 4.1 프로젝트 폴더 구조

# %%
folder_structure = """
my_investment_system/
│
├── config/
│   └── .env                    # API 키 설정
│
├── data/
│   ├── raw/                    # 원본 데이터
│   ├── processed/              # 가공 데이터
│   └── database.db             # SQLite DB
│
├── src/
│   ├── __init__.py
│   ├── data_collector.py       # 데이터 수집 모듈
│   ├── analyzer.py             # 분석 모듈
│   ├── visualizer.py           # 시각화 모듈
│   └── reporter.py             # 리포트 생성 모듈
│
├── apps/
│   └── dashboard.py            # Streamlit 대시보드
│
├── outputs/
│   ├── charts/                 # 차트 이미지
│   └── reports/                # PDF/Excel 리포트
│
├── main.py                     # 메인 실행 파일
├── requirements.txt            # 의존성
└── README.md                   # 프로젝트 설명
"""

print("[프로젝트 폴더 구조]")
print(folder_structure)

# %% [markdown]
# ### 4.2 핵심 모듈 템플릿
#
# `templates/project_template.py` 파일을 참고하세요.

# %%
# 템플릿 코드 미리보기
template_preview = '''
"""
투자 분석 자동화 시스템 - 템플릿
"""

# ============================================
# 1. 데이터 수집 모듈
# ============================================
class DataCollector:
    """데이터 수집 클래스"""
    
    def __init__(self):
        self.stock_data = None
        self.economic_data = None
    
    def collect_stock_data(self, stock_code, start_date, end_date):
        """주가 데이터 수집 (pykrx)"""
        pass
    
    def collect_economic_data(self, indicators, start_date, end_date):
        """경제 지표 수집 (FRED API)"""
        pass

# ============================================
# 2. 분석 모듈
# ============================================
class Analyzer:
    """분석 클래스"""
    
    def calculate_returns(self, df):
        """수익률 계산"""
        pass
    
    def technical_analysis(self, df):
        """기술적 분석"""
        pass
    
    def ai_analysis(self, text):
        """AI 분석 (선택)"""
        pass

# ============================================
# 3. 리포트 모듈
# ============================================
class Reporter:
    """리포트 생성 클래스"""
    
    def generate_pdf(self, data, output_path):
        """PDF 리포트 생성"""
        pass
    
    def generate_excel(self, data, output_path):
        """Excel 리포트 생성"""
        pass
    
    def send_email(self, recipient, subject, body, attachments):
        """이메일 발송"""
        pass

# ============================================
# 4. 메인 파이프라인
# ============================================
def main():
    """메인 실행 함수"""
    # 1. 데이터 수집
    collector = DataCollector()
    stock_data = collector.collect_stock_data("005930", "20240101", "20241231")
    
    # 2. 분석
    analyzer = Analyzer()
    analysis_result = analyzer.technical_analysis(stock_data)
    
    # 3. 리포트 생성
    reporter = Reporter()
    reporter.generate_pdf(analysis_result, "report.pdf")
    
    print("파이프라인 완료!")

if __name__ == "__main__":
    main()
'''

print("[템플릿 코드 미리보기]")
print(template_preview)

# %% [markdown]
# ---
# ## 5. 프로젝트 예시 아이디어
#
# ### 예시 1: 개인 포트폴리오 모니터링
# - 보유 종목 수익률 추적
# - 포트폴리오 비중 시각화
# - 주간 리포트 이메일 발송
#
# ### 예시 2: 경제 지표 대시보드
# - FRED 경제 지표 모니터링
# - 금리-환율-주가 상관관계 분석
# - 월간 경제 동향 리포트
#
# ### 예시 3: AI 투자 리서치 어시스턴트
# - 뉴스/공시 자동 수집
# - LLM 요약 및 감성 분석
# - 일일 투자 인사이트 제공
#
# ### 예시 4: 자동 매매 시그널
# - 기술적 지표 기반 매매 신호
# - 백테스팅 결과
# - 알림 발송

# %% [markdown]
# ---
# ## 6. 발표 준비
#
# ### 발표 구성 (10-15분)
#
# 1. **프로젝트 소개** (2분)
#    - 목표 및 동기
#    - 해결하려는 문제
#
# 2. **시스템 구조** (3분)
#    - 아키텍처 설명
#    - 사용 기술 스택
#
# 3. **핵심 기능 데모** (5분)
#    - 데이터 수집 → 분석 → 결과
#    - 실제 동작 시연
#
# 4. **결과물 소개** (3분)
#    - 대시보드 / 리포트
#    - 자동화 결과
#
# 5. **회고 및 향후 계획** (2분)
#    - 배운 점
#    - 개선 방향

# %% [markdown]
# ---
# ## 학습 정리
#
# ### 오늘의 산출물
# 1. 프로젝트 정의서 (작성 필요)
# 2. 체크리스트
# 3. 폴더 구조 설계
# 4. 코드 템플릿 확인
#
# ### 40차시까지 준비사항
# - [ ] 프로젝트 정의서 완성
# - [ ] 핵심 기능 구현
# - [ ] 통합 테스트
# - [ ] 발표 자료 준비
#
# ---
#
# ### 다음 차시 (40차시)
# - 프로젝트 발표 및 피드백
# - 코드 리뷰
# - 과정 전체 회고

# %%
